---
title: "Online Learning & Technology - Complete Analyses"
author: "Sihong"
date: "12/7/2020"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages, include = FALSE}
library(here)
library(knitr)
library(readr)
library(haven)
library(tidyverse)
```


```{r, echo=FALSE, message = FALSE}
#Define functions
moe.p = function(p, n){
  q = 1-p
  moe = 1.96*sqrt((p*q)/n)
  return(moe)
}

moe.m = function(sd,n){
  moe = 1.96*sd/sqrt(n)
  return(moe)}

combine.cat = function(x, cols, id, newvar.name){
  subset = x[,c(id, "Week", cols)]
  names(subset) = c("id", "Week", paste0("X",1:length(cols)))
  subset = suppressWarnings(gather(subset, "key", "value", -id, -Week))
  subset = filter(subset, !is.na(value))
  subset$key = gsub("X", "", subset$key)
  subset = group_by(subset, id, Week)
  subset = summarise(subset, newvar = paste(key, collapse = ",")) %>% ungroup()
  names(subset) = c(id,"Week", newvar.name)
  x = suppressMessages(full_join(x, subset))
  return(x)
}

find_items = function(string, data2){
  items = names(data2)
  locations = which(grepl(string, items))
  final = items[locations]
  return(final)
}

my.max = function(x) ifelse (!all(is.na(x)), max(x,na.rm = TRUE), NA)
my.min = function(x) ifelse (!all(is.na(x)), min(x,na.rm = TRUE), NA)
```

```{r, echo=FALSE, message = FALSE, warning = FALSE}
#OR load master data file
master = read_sav(here("data/MasterFile_groupings.sav"))

# Remove cases should be excluded
master <- master %>%
  filter ( CaregiverID != "" & is.na(Exclude) == T)

master = master %>%
  group_by(CaregiverID, Week) %>%
  filter(row_number() == max(row_number())) %>%
  ungroup()

```

```{r, echo=FALSE, message = FALSE, warning = FALSE}
#Code demographics
master <- master %>%
  mutate (month = case_when(
                  Week == 0 ~ "Pre-COVID",
                  Week >0 & Week <= 4 ~ "April",
                  Week >=5 & Week <=8 ~ "May",
                  Week >=9 & Week <=13 ~ "June",
                  Week >=14 & Week <=17 ~ "July",
                  Week >=18 & Week <=21 ~ "August",
                  Week >=22 & Week <=26 ~ "September",
                  Week >=27 ~ "October"), 
           baseline = case_when (Week - BaselineWeek == 1 ~ 1, 
                                 Week - BaselineWeek > 1 ~ 0))

##Race/ethnicity - 1 = black, 2 = latinx, 3 = white

master <- master %>%
  mutate (RaceGroup = na_if (RaceGroup, 99))%>%
    mutate(
      minority = ifelse(RaceGroup != 5, 1, 0),
      black = ifelse(RaceGroup == 3, 1, 0),
      native = ifelse(RaceGroup == 1, 1, 0),
      asian = ifelse(RaceGroup == 2, 1, 0),
      hawaii = ifelse(RaceGroup == 4, 1, 0),
      white = ifelse(RaceGroup == 5, 1, 0),
      other_race = ifelse(RaceGroup %in% c(6, 7), 1, 0))

master <- master %>%
      mutate(latinx = case_when(
        DEMO.008 == 1 ~ 1,
        DEMO.008 == 0 ~ 0,
        DEMO.008.2 == 0 ~ 0,
        DEMO.008.2 == 1 ~ 1,
        DEMO.008.2 == 2 ~ 1,
        TRUE ~ NA_real_))

master <- master %>%
mutate (race_ethnic = case_when(
      black == 1 ~ "1",
      latinx == 1 ~ "2",
      !is.na(black) ~ "3",
      !is.na(latinx) ~ "3",
      TRUE ~ NA_character_))  

##Povertyline - 0 = high income, 1 = low income
master <- master %>%
  mutate (poverty_cat = FPL.150)

#Material hardship
master <- master %>%
  combine.cat(cols = find_items("FSTR.002_.{1}$", master), 
              id = "CaregiverID",
              newvar.name = "FSTR.002_cat")
  

master <- master %>%
  mutate (diff_pay_food = case_when(
                          FSTR.001 == 0 ~ 0, 
                          grepl("1", FSTR.002_cat) ~ 1,
                          TRUE ~ NA_real_), 
          diff_pay_utilities = case_when(
                          FSTR.001 == 0 ~ 0, 
                          grepl("3", FSTR.002_cat) ~ 1,
                          TRUE ~ NA_real_),
          diff_pay_house = case_when(
                          FSTR.001 == 0 ~ 0, 
                          grepl("2", FSTR.002_cat) ~ 1,
                          TRUE ~ NA_real_),
          diff_pay_healthcare = case_when(
                          FSTR.001 == 0 ~ 0, 
                          grepl("4", FSTR.002_cat) ~ 1,
                          TRUE ~ NA_real_),
          diff_pay_social = case_when(
                          FSTR.001 == 0 ~ 0, 
                          grepl("5", FSTR.002_cat) ~ 1,
                          TRUE ~ NA_real_),
          diff_pay_emotional = case_when(
                          FSTR.001 == 0 ~ 0, 
                          grepl("6", FSTR.002_cat) ~ 1,
                          TRUE ~ NA_real_),
          diff_pay_childcare = case_when(
                          FSTR.001 == 0 ~ 0, 
                          grepl("7", FSTR.002_cat) ~ 1,
                          TRUE ~ NA_real_),
          diff_pay_other = case_when(
                          FSTR.001 == 0 ~ 0, 
                          grepl("8", FSTR.002_cat) ~ 1,
                          TRUE ~ NA_real_))

master <- master %>%
  rowwise() %>%
  mutate(material_hardship = case_when(
    Week == 0 ~ NA_real_,
    TRUE ~ sum(c_across(starts_with("diff_pay_")), na.rm=T))) %>%
  ungroup() %>%
  mutate(num_hardship = material_hardship,
    material_hardship = ifelse(material_hardship > 0, 1, 0)) 

## Children with special needs
master <- combine.cat(x = master, 
                       cols = find_items("HEALTH.005_[0-9]{1}$", master), 
                       id = "CaregiverID",
                       newvar.name = "HEALTH.005_cat")
master <- master %>%
   mutate (disability = case_when (HEALTH.005_1 == 1 ~ 1,
                                   HEALTH.005_2 == 1 ~ 1,
                                   HEALTH.005_3 == 1 ~ 1,
                                   HEALTH.005_4 == 1 ~ 1,
                                   HEALTH.005_5 == 1 ~ 0,
                                   HEALTH.005_6 == 1 ~ 1,
                                   TRUE ~ NA_real_))


## Single parent status
master <- master %>%
  mutate (single = case_when (
                   DEMO.002 %in% c(3,4,5,7,8)~1, 
                   DEMO.011 %in% c(2,4)~1,
                   !is.na(DEMO.002)~0,
                   !is.na(DEMO.011)~0,
                   TRUE ~ NA_real_))
                     
## Employment status
master <- combine.cat (x = master,
                       cols = find_items ("JOB.010_.{1,2}$", master), 
                       id = "CaregiverID",
                       newvar.name = "JOB.010_cat")
  
master$JOB.010_cat = gsub("10", "0", master$JOB.010_cat)
master$working_pre = ifelse (grepl("[1,2,6]", master$JOB.010_cat), 1, 0)
master = combine.cat (x = master,
                       cols = find_items ("JOB.008_.{1,2}$", master), 
                       id = "CaregiverID",
                       newvar.name = "JOB.008_cat")
master$JOB.008_cat = gsub("10", "0", master$JOB.008_cat)
master <- master %>%
  mutate (work_status = case_when(
                        grepl ("1", JOB.008_cat) ~ "1", 
                        grepl ("2", JOB.008_cat) ~ "1", 
                        grepl ("3", JOB.008_cat) ~ "0", 
                        grepl ("4", JOB.008_cat) ~ "0", 
                        grepl ("5", JOB.008_cat) ~ "1", 
                        JOB.008.2 == 1 ~ "1",
                        JOB.008.2 %in% c(2,3) ~ "0",
                        TRUE~NA_character_),
          work_status_pre = case_when(
                        grepl ("1", JOB.010_cat) ~ "1", 
                        grepl ("2", JOB.010_cat) ~ "1", 
                        grepl ("3", JOB.010_cat) ~ "0", 
                        grepl ("4", JOB.010_cat) ~ "0", 
                        grepl ("5", JOB.010_cat) ~ "1", 
                        TRUE~NA_character_))
#1 = stable employed 2 = became unemployed 3 = became employed4 = stable unemployed

# Region
master <- master %>%
  mutate (region = na_if (DEMO.001.b, 5))

master_dem <- master %>%
  group_by (CaregiverID) %>%
  summarise (BaselineWeek = my.max (BaselineWeek),
             race_ethnic = my.max(race_ethnic),
             poverty_cat = my.max(poverty_cat),
             material_hardship = my.max(material_hardship),
             disability = my.max (disability),
             single = my.max (single),
             work_status = my.max (work_status),
             work_status_pre = my.max (work_status_pre), 
             region = my.max(region))%>%
  mutate ( ep_change = case_when(
                        work_status == 1 & work_status_pre == 1 ~ "1", 
                        work_status == 1 & work_status_pre == 0 ~ "2", 
                        work_status == 0 & work_status_pre == 1 ~ "3", 
                        work_status == 0 & work_status_pre == 0 ~ "4", 
                        TRUE~NA_character_))%>%
  mutate (race_ethnic = case_when (
                        race_ethnic == 1 ~ "Black", 
                        race_ethnic == 2 ~ "Latinx", 
                        race_ethnic == 3 ~ "White", 
                        TRUE~NA_character_),
          poverty_cat = case_when (
                        poverty_cat == 1 ~ "Low income", 
                        poverty_cat == 0 ~ "High income", 
                        TRUE~NA_character_),
          material_hardship = case_when (
                        material_hardship == 1 ~ "With material hardship", 
                        material_hardship == 0 ~ "Without material hardship", 
                        TRUE~NA_character_),
          disability = case_when (
                        disability == 1 ~ "With disability", 
                        disability == 0 ~ "Without disability", 
                        TRUE~NA_character_),
          single = case_when (
                        single == 1 ~ "Single parent", 
                        single == 0 ~ "Dual parent", 
                        TRUE~NA_character_),
          work_status = case_when (
                        work_status == 1 ~ "Employed", 
                        work_status == 0 ~ "Unemployed", 
                        TRUE~NA_character_),
          work_status_pre = case_when (
                        work_status_pre == 1 ~ "Employed", 
                        work_status_pre == 0 ~ "Unemployed", 
                        TRUE~NA_character_),
          ep_change = case_when (
                        ep_change == 1 ~ "Stable employed", 
                        ep_change == 2 ~ "Became employed", 
                        ep_change == 3 ~ "Became unemployed",
                        ep_change == 4 ~ "Stable unemployed",
                        TRUE~NA_character_), 
          region = case_when (
                        region == 1 ~ "Northeast", 
                        region == 2 ~ "Midwest", 
                        region == 3 ~ "South", 
                        region == 4 ~ "West",
                        TRUE~NA_character_))

```

```{r, echo=FALSE, message = FALSE, warning = FALSE}
# Extract Relevant Variables
##RL questions - online learning

rl <- master %>%
  select (CaregiverID, Week, baseline, starts_with ("RL."))%>%
  filter (Week == 33)

rl <- merge (x = master_dem, y = rl,  by.x = "CaregiverID", by.y = "CaregiverID", all.y = T)

## Technology - Internet

internet <- master %>%
  select (CaregiverID, Week, baseline, starts_with ("INTERNET"))%>%
  filter (Week == 33 | Week == 27)%>%
  group_by (CaregiverID)%>%
  filter (Week == max (Week))%>%
  ungroup()

internet <- merge (x = master_dem, y = internet,  by.x = "CaregiverID", by.y = "CaregiverID", all.y = T)

```

# Sample Disclaimer
  * Remote Learning are based on responses collected from 943 caregivers between the dates of November 17th, 2020 and November 19th, 2020. These caregivers represent a range of voices: 12.33% are Black/African American, 16.68% are Latinx, and 25.62% live at or below 1.5 times the federal poverty line. Proportions/percentages are calculated based on the item-level response rates, not out of the total sample size. The data for these analyses are not weighted. \
  * Internet Access questions are based on responses collected from 1,701 caregivers between the dates of October 5th, 2020 and November 19th, 2020. These caregivers represent a range of voices: 9.24% are Black/African American, 15.13% are Latinx, and 26.90% live at or below 1.5 times the federal poverty line. Proportions/percentages are calculated based on the item-level response rates, not out of the total sample size. The data for these analyses are not weighted. \

```{r, echo=FALSE, message = FALSE, warning = FALSE, results = FALSE}
table(rl$race_ethnic)
table(rl$poverty_cat)

table(internet$race_ethnic)
table(internet$poverty_cat)
```

# Remote Learning 
## Percentage of Families with Child(ren) Using Remote Learning
  * Question: are there any pre-school/school-aged children in your household who are currently learning remotely? - yes/no\

### Overall
  * Results: Out of the 943 families, there were 36.69% (n = 346) families having child(ren) currently learning remotely.\

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_total <- rl %>%
  summarise (n = n(),
             pct = sum(RL.001, na.rm = T)/n)%>%
  mutate (count = pct * n)
print(rl_total)
```

### By Race/Ethnicity
  * Significantly higher percentage of Black (48.28%) and Latinx (47.13%) families had child(ren) learning remotely compared to White families (32.04%)\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_total <- rl %>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             prop = sum(RL.001, na.rm = T)/n)%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_total %>%
  ggplot(mapping = aes (x = race_ethnic, y = prop*100, fill = race_ethnic )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1)) 

```

### By Poverty Level
  * Significantly higher percentage of low-income (51.88%) families had child(ren) learning remotely compared to high-income families (31.41%)\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_total <- rl %>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             prop = sum(RL.001, na.rm = T)/n)%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_total %>%
  ggplot(mapping = aes (x = poverty_cat, y = prop*100, fill = poverty_cat )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1)) 

```

### By Poverty Level & Race/Ethnicity
  * Black families, no matter high- or low-income, had high percentage of families with child(ren) learning remotely\
  * Difference by income level mainly presented among White families. \
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_total <- rl %>%
  filter (poverty_cat != "NA" & race_ethnic != "NA")%>%
  group_by (poverty_cat, race_ethnic)%>%
  summarise (n = n(),
             prop = sum(RL.001, na.rm = T)/n)%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_total %>%
  ggplot(mapping = aes (x = race_ethnic, y = prop*100, fill = race_ethnic )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1)) +
  facet_wrap (~poverty_cat)

```

### By Single Parent Status
  * Significantly higher percentage of single-parent (56.18%) families had child(ren) learning remotely compared to dual-parent families (34.51%)\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_total <- rl %>%
  filter (single != "NA")%>%
  group_by (single)%>%
  summarise (n = n(),
             prop = sum(RL.001, na.rm = T)/n)%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_total %>%
  ggplot(mapping = aes (x = single, y = prop*100, fill = single )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1)) 

```

### By Children's Disability Status
  * Significantly higher percentage of families of children with special needs (58.49%) had child(ren) learning remotely compared to families of children without special needs (33.57%)\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_total <- rl %>%
  filter (disability != "NA")%>%
  group_by (disability)%>%
  summarise (n = n(),
             prop = sum(RL.001, na.rm = T)/n)%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_total %>%
  ggplot(mapping = aes (x = disability, y = prop*100, fill = disability )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1)) 

```

### By Caregivers' Current Employment Status
  * Marginally significant higher percentage of unemployed caregivers (43.17%) had child(ren) learning remotely compared to employed caregivers (34.03%)\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_total <- rl %>%
  filter (work_status != "NA")%>%
  group_by (work_status)%>%
  summarise (n = n(),
             prop = sum(RL.001, na.rm = T)/n)%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_total %>%
  ggplot(mapping = aes (x = work_status, y = prop*100, fill = work_status )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1)) 

```


### By Region
  * Higher percentage of Midwest (40.26%) and West (38.89%) families had child(ren) learning remotely than the Northeast (35.65%) and the South (31.92%), but the differences were not significant. \
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_total <- rl %>%
  filter (region != "NA")%>%
  group_by (region)%>%
  summarise (n = n(),
             prop = sum(RL.001, na.rm = T)/n)%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_total %>%
  ggplot(mapping = aes (x = region, y = prop*100, fill = region )) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1)) 

```

## Types of Remote Learning
  * Question: What kind of virtual learning activities does your child's preschool/school use? Select all that apply:\
    - Individual calls with children/families\
    - Sending schedules and resources\
    - Large group video meetings (e.g., morning meeting)\
    - Recording videos (e.g., story time)\
    - Sending materials to families\
    - Small group video meetings (e.g., small group projects)\
    - None of the above\
  * Analyses based one the sample of caregivers who reported having child(ren) using remote learning (n = 346)\

### Overall

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_type <- rl %>%
  filter (RL.001 == 1)%>%
  summarise (n = n(),
             individual_call = sum(RL.002_1, na.rm = T)/n,
             sending_schedules = sum(RL.002_2, na.rm = T)/n,
             large_group_meetings = sum(RL.002_3, na.rm = T)/n,
             recording_videos = sum(RL.002_4, na.rm = T)/n,
             sending_materials = sum(RL.002_5, na.rm = T)/n,
             small_group_meetings = sum(RL.002_6, na.rm = T)/n)%>%
  pivot_longer (cols = c("individual_call", "sending_schedules", "large_group_meetings", "recording_videos", "sending_materials", "small_group_meetings"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_type %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))

```

### By Race/Ethnicity

  * Compared to Latinx families, significantly more White families used remote learning to record videos or send schedules/other resources\

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_type <- rl %>%
  filter (RL.001 == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             individual_call = sum(RL.002_1, na.rm = T)/n,
             sending_schedules = sum(RL.002_2, na.rm = T)/n,
             large_group_meetings = sum(RL.002_3, na.rm = T)/n,
             recording_videos = sum(RL.002_4, na.rm = T)/n,
             sending_materials = sum(RL.002_5, na.rm = T)/n,
             small_group_meetings = sum(RL.002_6, na.rm = T)/n)%>%
  pivot_longer (cols = c("individual_call", "sending_schedules", "large_group_meetings", "recording_videos", "sending_materials", "small_group_meetings"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_type %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~types)

```

### By Poverty Levels

  * Significantly high percentage of high-income families used remote learning to record videos compared to low-income families\

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_type <- rl %>%
  filter (RL.001 == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             individual_call = sum(RL.002_1, na.rm = T)/n,
             sending_schedules = sum(RL.002_2, na.rm = T)/n,
             large_group_meetings = sum(RL.002_3, na.rm = T)/n,
             recording_videos = sum(RL.002_4, na.rm = T)/n,
             sending_materials = sum(RL.002_5, na.rm = T)/n,
             small_group_meetings = sum(RL.002_6, na.rm = T)/n)%>%
  pivot_longer (cols = c("individual_call", "sending_schedules", "large_group_meetings", "recording_videos", "sending_materials", "small_group_meetings"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_type %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))

```

### By Single Parent Status

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_type <- rl %>%
  filter (RL.001 == 1)%>%
  filter (single != "NA")%>%
  group_by (single)%>%
  summarise (n = n(),
             individual_call = sum(RL.002_1, na.rm = T)/n,
             sending_schedules = sum(RL.002_2, na.rm = T)/n,
             large_group_meetings = sum(RL.002_3, na.rm = T)/n,
             recording_videos = sum(RL.002_4, na.rm = T)/n,
             sending_materials = sum(RL.002_5, na.rm = T)/n,
             small_group_meetings = sum(RL.002_6, na.rm = T)/n)%>%
  pivot_longer (cols = c("individual_call", "sending_schedules", "large_group_meetings", "recording_videos", "sending_materials", "small_group_meetings"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_type %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = single)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))

```

### By Child Disability Status

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_type <- rl %>%
  filter (RL.001 == 1)%>%
  filter (disability != "NA")%>%
  group_by (disability)%>%
  summarise (n = n(),
             individual_call = sum(RL.002_1, na.rm = T)/n,
             sending_schedules = sum(RL.002_2, na.rm = T)/n,
             large_group_meetings = sum(RL.002_3, na.rm = T)/n,
             recording_videos = sum(RL.002_4, na.rm = T)/n,
             sending_materials = sum(RL.002_5, na.rm = T)/n,
             small_group_meetings = sum(RL.002_6, na.rm = T)/n)%>%
  pivot_longer (cols = c("individual_call", "sending_schedules", "large_group_meetings", "recording_videos", "sending_materials", "small_group_meetings"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_type %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = disability)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))

```

### By Caregivers' Employment Status

  * Significantly more employed caregivers used remote learning opportunities used remote learning for individual calls compared to unemployed caregivers\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_type <- rl %>%
  filter (RL.001 == 1)%>%
  filter (work_status != "NA")%>%
  group_by (work_status)%>%
  summarise (n = n(),
             individual_call = sum(RL.002_1, na.rm = T)/n,
             sending_schedules = sum(RL.002_2, na.rm = T)/n,
             large_group_meetings = sum(RL.002_3, na.rm = T)/n,
             recording_videos = sum(RL.002_4, na.rm = T)/n,
             sending_materials = sum(RL.002_5, na.rm = T)/n,
             small_group_meetings = sum(RL.002_6, na.rm = T)/n)%>%
  pivot_longer (cols = c("individual_call", "sending_schedules", "large_group_meetings", "recording_videos", "sending_materials", "small_group_meetings"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_type %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = work_status)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))

```

### By Region

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_type <- rl %>%
  filter (RL.001 == 1)%>%
  filter (region != "NA")%>%
  group_by (region)%>%
  summarise (n = n(),
             individual_call = sum(RL.002_1, na.rm = T)/n,
             sending_schedules = sum(RL.002_2, na.rm = T)/n,
             large_group_meetings = sum(RL.002_3, na.rm = T)/n,
             recording_videos = sum(RL.002_4, na.rm = T)/n,
             sending_materials = sum(RL.002_5, na.rm = T)/n,
             small_group_meetings = sum(RL.002_6, na.rm = T)/n)%>%
  pivot_longer (cols = c("individual_call", "sending_schedules", "large_group_meetings", "recording_videos", "sending_materials", "small_group_meetings"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_type %>%
  ggplot(mapping = aes (y = region, x = prop*100, fill = region)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~types)

```

## Challenges of Remote Learning
  * Question: What are the challenges of remote instruction with young children and families? Select all that apply:\
    - Engaging children through remote instruction\
    - Developing an engaging distance curriculum\
    - Access to computers and technology for children and families\
    - Access to computer and technology for staff\
    - Managing own children's remote instruction\
    - Caring for own family members\
    - Attendance during remote instruction\
    - other\
    - None of the above\
    - Not applicable\
  * Analyses based one the sample of caregivers who reported having child(ren) using remote learning (n = 346)\

### Overall

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_challenge <- rl %>%
  filter (RL.001 == 1)%>%
  summarise (n = n(),
             engaging_children = sum(RL.003_1, na.rm = T)/n,
             developing_curriculum = sum(RL.003_2, na.rm = T)/n,
             access_tech_children = sum(RL.003_3, na.rm = T)/n,
             access_tech_staff = sum(RL.003_4, na.rm = T)/n,
             managing_own_children = sum(RL.003_5, na.rm = T)/n,
             caring_family_members = sum(RL.003_6, na.rm = T)/n, 
             attendance = sum(RL.003_7, na.rm = T)/n, )%>%
  pivot_longer (cols = c("engaging_children", "developing_curriculum", "access_tech_children", "access_tech_staff", "managing_own_children", "caring_family_members", "attendance"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_challenge %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))

```

### By Race/Ethnicity

  * Significantly more White and Latinx families reported "caring for family members" being a challenge for children's remote learning, compared to Black families\

```{r, echo=FALSE, message = FALSE, warning = FALSE}
### By Race/Ethnicity
rl_challenge <- rl %>%
  filter (RL.001 == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             engaging_children = sum(RL.003_1, na.rm = T)/n,
             developing_curriculum = sum(RL.003_2, na.rm = T)/n,
             access_tech_children = sum(RL.003_3, na.rm = T)/n,
             access_tech_staff = sum(RL.003_4, na.rm = T)/n,
             managing_own_children = sum(RL.003_5, na.rm = T)/n,
             caring_family_members = sum(RL.003_6, na.rm = T)/n, 
             attendance = sum(RL.003_7, na.rm = T)/n, )%>%
  pivot_longer (cols = c("engaging_children", "developing_curriculum", "access_tech_children", "access_tech_staff", "managing_own_children", "caring_family_members", "attendance"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_challenge %>%
  ggplot(mapping = aes (y = race_ethnic, x = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1)) +
  facet_wrap (~types, nrow = 2)

```

### By Poverty Level

```{r, echo=FALSE, message = FALSE, warning = FALSE}
### By Poverty Level
rl_challenge <- rl %>%
  filter (RL.001 == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             engaging_children = sum(RL.003_1, na.rm = T)/n,
             developing_curriculum = sum(RL.003_2, na.rm = T)/n,
             access_tech_children = sum(RL.003_3, na.rm = T)/n,
             access_tech_staff = sum(RL.003_4, na.rm = T)/n,
             managing_own_children = sum(RL.003_5, na.rm = T)/n,
             caring_family_members = sum(RL.003_6, na.rm = T)/n, 
             attendance = sum(RL.003_7, na.rm = T)/n, )%>%
  pivot_longer (cols = c("engaging_children", "developing_curriculum", "access_tech_children", "access_tech_staff", "managing_own_children", "caring_family_members", "attendance"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_challenge %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1)) 

```

### By Single Parent Status

```{r, echo=FALSE, message = FALSE, warning = FALSE}
### By Single Parent Status
rl_challenge <- rl %>%
  filter (RL.001 == 1)%>%
  filter (single != "NA")%>%
  group_by (single)%>%
  summarise (n = n(),
             engaging_children = sum(RL.003_1, na.rm = T)/n,
             developing_curriculum = sum(RL.003_2, na.rm = T)/n,
             access_tech_children = sum(RL.003_3, na.rm = T)/n,
             access_tech_staff = sum(RL.003_4, na.rm = T)/n,
             managing_own_children = sum(RL.003_5, na.rm = T)/n,
             caring_family_members = sum(RL.003_6, na.rm = T)/n, 
             attendance = sum(RL.003_7, na.rm = T)/n, )%>%
  pivot_longer (cols = c("engaging_children", "developing_curriculum", "access_tech_children", "access_tech_staff", "managing_own_children", "caring_family_members", "attendance"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_challenge %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = single)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1)) 

```

### By Child Disability Status

```{r, echo=FALSE, message = FALSE, warning = FALSE}
### By Child Disability Status
rl_challenge <- rl %>%
  filter (RL.001 == 1)%>%
  filter (disability != "NA")%>%
  group_by (disability)%>%
  summarise (n = n(),
             engaging_children = sum(RL.003_1, na.rm = T)/n,
             developing_curriculum = sum(RL.003_2, na.rm = T)/n,
             access_tech_children = sum(RL.003_3, na.rm = T)/n,
             access_tech_staff = sum(RL.003_4, na.rm = T)/n,
             managing_own_children = sum(RL.003_5, na.rm = T)/n,
             caring_family_members = sum(RL.003_6, na.rm = T)/n, 
             attendance = sum(RL.003_7, na.rm = T)/n, )%>%
  pivot_longer (cols = c("engaging_children", "developing_curriculum", "access_tech_children", "access_tech_staff", "managing_own_children", "caring_family_members", "attendance"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_challenge %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = disability)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1)) 

```

### By Caregivers' Employment Status

```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_challenge <- rl %>%
  filter (RL.001 == 1)%>%
  filter (work_status != "NA")%>%
  group_by (work_status)%>%
  summarise (n = n(),
             engaging_children = sum(RL.003_1, na.rm = T)/n,
             developing_curriculum = sum(RL.003_2, na.rm = T)/n,
             access_tech_children = sum(RL.003_3, na.rm = T)/n,
             access_tech_staff = sum(RL.003_4, na.rm = T)/n,
             managing_own_children = sum(RL.003_5, na.rm = T)/n,
             caring_family_members = sum(RL.003_6, na.rm = T)/n, 
             attendance = sum(RL.003_7, na.rm = T)/n, )%>%
  pivot_longer (cols = c("engaging_children", "developing_curriculum", "access_tech_children", "access_tech_staff", "managing_own_children", "caring_family_members", "attendance"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_challenge %>%
  ggplot(mapping = aes (y = types, x = prop*100, fill = work_status)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1)) 

```

### By Region

```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_challenge <- rl %>%
  filter (RL.001 == 1)%>%
  filter (region != "NA")%>%
  group_by (region)%>%
  summarise (n = n(),
             engaging_children = sum(RL.003_1, na.rm = T)/n,
             developing_curriculum = sum(RL.003_2, na.rm = T)/n,
             access_tech_children = sum(RL.003_3, na.rm = T)/n,
             access_tech_staff = sum(RL.003_4, na.rm = T)/n,
             managing_own_children = sum(RL.003_5, na.rm = T)/n,
             caring_family_members = sum(RL.003_6, na.rm = T)/n, 
             attendance = sum(RL.003_7, na.rm = T)/n, )%>%
  pivot_longer (cols = c("engaging_children", "developing_curriculum", "access_tech_children", "access_tech_staff", "managing_own_children", "caring_family_members", "attendance"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_challenge %>%
  ggplot(mapping = aes (y = region, x = prop*100, fill = region)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1)) +
  facet_wrap (~types, nrow = 2)

```

## Hours Spent on Remote Learning
  * Questions: \
    + How much total time per day is your child on a virtual learning platform? \
    + How much time does an individual remote learning session last? \
  * Responses: \
    - 1 = Less than 30 minutes
    - 2 = 31-60 minutes
    - 3 = 61-120 minutes
    - 4 = 121-180 minutes
    - 5 = more than 180 minutes
    - 6 = other
  * Analyses based on the sample of caregivers who reported having child(ren) using remote learning (n = 346)\
  

### Distribution of Original Responses

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_hours <- rl %>%
  filter (RL.001 == 1)%>%
  mutate (hour_pd_15 = ifelse (RL.007 == 1, 1, 0), 
          hour_pd_45 = ifelse (RL.007 == 2, 1, 0), 
          hour_pd_90 = ifelse (RL.007 == 3, 1, 0), 
          hour_pd_150 = ifelse (RL.007 == 4, 1, 0), 
          hour_pd_180 = ifelse (RL.007 == 5, 1, 0), 
          hour_pd_md = case_when (RL.007 == 1 ~ 15, 
                               RL.007 == 2 ~ 45,
                               RL.007 == 3 ~ 90, 
                               RL.007 == 4 ~ 150, 
                               RL.007 == 5 ~ 180), 
          hour_sc_15 = ifelse (RL.008 == 1, 1, 0), 
          hour_sc_45 = ifelse (RL.008 == 2, 1, 0), 
          hour_sc_90 = ifelse (RL.008 == 3, 1, 0), 
          hour_sc_150 = ifelse (RL.008 == 4, 1, 0), 
          hour_sc_180 = ifelse (RL.008 == 5, 1, 0), 
          hour_sc_md = case_when (RL.008 == 1 ~ 15, 
                               RL.008 == 2 ~ 45,
                               RL.008 == 3 ~ 90, 
                               RL.008 == 4 ~ 150, 
                               RL.008 == 5 ~ 180))

rl_hours_pd <- rl_hours %>%
  summarise (n = n(),
             a.pd_below_30 = sum(hour_pd_15, na.rm = T)/n, 
             b.pd_31_60 = sum(hour_pd_45, na.rm = T)/n, 
             c.pd_61_120 = sum(hour_pd_90, na.rm = T)/n, 
             d.pd_121_180 = sum(hour_pd_150, na.rm = T)/n, 
             e.pd_above_180 = sum(hour_pd_180, na.rm = T)/n)%>%
pivot_longer (cols = c("a.pd_below_30", "b.pd_31_60", "c.pd_61_120", "d.pd_121_180", "e.pd_above_180"), names_to = "hours", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_hours_sc <- rl_hours %>%
  summarise (n = n(),
             a.sc_below_30 = sum(hour_sc_15, na.rm = T)/n, 
             b.sc_31_60 = sum(hour_sc_45, na.rm = T)/n, 
             c.sc_61_120 = sum(hour_sc_90, na.rm = T)/n, 
             d.sc_121_180 = sum(hour_sc_150, na.rm = T)/n, 
             e.sc_above_180 = sum(hour_sc_180, na.rm = T)/n)%>%
pivot_longer (cols = c("a.sc_below_30", "b.sc_31_60", "c.sc_61_120", "d.sc_121_180", "e.sc_above_180"), names_to = "hours", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
rl_hours_pd %>%
  ggplot(mapping = aes (y = hours, x = prop*100, fill = hours)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Hours on Remote Learning Per Day")

rl_hours_sc %>%
  ggplot(mapping = aes (y = hours, x = prop*100, fill = hours)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(xmin = ci_low*100, 
                    xmax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Hours on Remote Learning Per Individual Session")

```
### Coded Mean Time 

#### Overall
  * On average, caregivers of children who are currently learning remotely reported that their children spent an average of 107.47 minutes (1.79 hours; SD = 62.32 minutes) per day on remote learning, with each session lasting for an average of 53.48 minutes (0.89 hours; SD = 45.61 minutes)\
  * Breakdown by groups were shown below. However, now significant differences were found. \
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_hours_pd <- rl_hours %>%
  summarise (n = n(),
             mean = mean(hour_pd_md, na.rm = T), 
             sd = sd(hour_pd_md, na.rm = T))%>%
  mutate (moe = map2_dbl(sd, n, moe.m), 
          ci_low = mean - moe, 
          ci_high = mean + moe, 
          type = "per_day")

rl_hours_sc <- rl_hours %>%
  summarise (n = n(),
             mean = mean(hour_sc_md, na.rm = T), 
             sd = sd(hour_sc_md, na.rm = T))%>%
  mutate (moe = map2_dbl(sd, n, moe.m), 
          ci_low = mean - moe, 
          ci_high = mean + moe, 
          type = "per_session")

rl_hours_mean <- rbind (rl_hours_pd, rl_hours_sc)
             
rl_hours_mean %>%
  ggplot(mapping = aes (x = type, y = mean, fill = type)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low, 
                    ymax = ci_high),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(mean,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))
```

#### By Race/Ethnicity
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_hours_pd <- rl_hours %>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             mean = mean(hour_pd_md, na.rm = T), 
             sd = sd(hour_pd_md, na.rm = T))%>%
  mutate (moe = map2_dbl(sd, n, moe.m), 
          ci_low = mean - moe, 
          ci_high = mean + moe, 
          type = "per_day")

rl_hours_sc <- rl_hours %>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             mean = mean(hour_sc_md, na.rm = T), 
             sd = sd(hour_sc_md, na.rm = T))%>%
  mutate (moe = map2_dbl(sd, n, moe.m), 
          ci_low = mean - moe, 
          ci_high = mean + moe, 
          type = "per_session")

rl_hours_mean <- rbind (rl_hours_pd, rl_hours_sc)
             
rl_hours_mean %>%
  ggplot(mapping = aes (x = race_ethnic, y = mean, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low, 
                    ymax = ci_high),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(mean,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~type)
```

#### By Poverty Level

```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_hours_pd <- rl_hours %>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             mean = mean(hour_pd_md, na.rm = T), 
             sd = sd(hour_pd_md, na.rm = T))%>%
  mutate (moe = map2_dbl(sd, n, moe.m), 
          ci_low = mean - moe, 
          ci_high = mean + moe, 
          type = "per_day")

rl_hours_sc <- rl_hours %>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             mean = mean(hour_sc_md, na.rm = T), 
             sd = sd(hour_sc_md, na.rm = T))%>%
  mutate (moe = map2_dbl(sd, n, moe.m), 
          ci_low = mean - moe, 
          ci_high = mean + moe, 
          type = "per_session")

rl_hours_mean <- rbind (rl_hours_pd, rl_hours_sc)
             
rl_hours_mean %>%
  ggplot(mapping = aes (x = poverty_cat, y = mean, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low, 
                    ymax = ci_high),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(mean,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~type)
```

#### By Single Parent Status

```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_hours_pd <- rl_hours %>%
  filter (single != "NA")%>%
  group_by (single)%>%
  summarise (n = n(),
             mean = mean(hour_pd_md, na.rm = T), 
             sd = sd(hour_pd_md, na.rm = T))%>%
  mutate (moe = map2_dbl(sd, n, moe.m), 
          ci_low = mean - moe, 
          ci_high = mean + moe, 
          type = "per_day")

rl_hours_sc <- rl_hours %>%
  filter (single != "NA")%>%
  group_by (single)%>%
  summarise (n = n(),
             mean = mean(hour_sc_md, na.rm = T), 
             sd = sd(hour_sc_md, na.rm = T))%>%
  mutate (moe = map2_dbl(sd, n, moe.m), 
          ci_low = mean - moe, 
          ci_high = mean + moe, 
          type = "per_session")

rl_hours_mean <- rbind (rl_hours_pd, rl_hours_sc)
             
rl_hours_mean %>%
  ggplot(mapping = aes (x = single, y = mean, fill = single)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low, 
                    ymax = ci_high),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(mean,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~type)
```

#### By Child Disability Status

```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_hours_pd <- rl_hours %>%
  filter (disability != "NA")%>%
  group_by (disability)%>%
  summarise (n = n(),
             mean = mean(hour_pd_md, na.rm = T), 
             sd = sd(hour_pd_md, na.rm = T))%>%
  mutate (moe = map2_dbl(sd, n, moe.m), 
          ci_low = mean - moe, 
          ci_high = mean + moe, 
          type = "per_day")

rl_hours_sc <- rl_hours %>%
  filter (disability != "NA")%>%
  group_by (disability)%>%
  summarise (n = n(),
             mean = mean(hour_sc_md, na.rm = T), 
             sd = sd(hour_sc_md, na.rm = T))%>%
  mutate (moe = map2_dbl(sd, n, moe.m), 
          ci_low = mean - moe, 
          ci_high = mean + moe, 
          type = "per_session")

rl_hours_mean <- rbind (rl_hours_pd, rl_hours_sc)
             
rl_hours_mean %>%
  ggplot(mapping = aes (x = disability, y = mean, fill = disability)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low, 
                    ymax = ci_high),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(mean,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~type)
```

#### By Caregivers' Employment Status

```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_hours_pd <- rl_hours %>%
  filter (work_status != "NA")%>%
  group_by (work_status)%>%
  summarise (n = n(),
             mean = mean(hour_pd_md, na.rm = T), 
             sd = sd(hour_pd_md, na.rm = T))%>%
  mutate (moe = map2_dbl(sd, n, moe.m), 
          ci_low = mean - moe, 
          ci_high = mean + moe, 
          type = "per_day")

rl_hours_sc <- rl_hours %>%
  filter (work_status != "NA")%>%
  group_by (work_status)%>%
  summarise (n = n(),
             mean = mean(hour_sc_md, na.rm = T), 
             sd = sd(hour_sc_md, na.rm = T))%>%
  mutate (moe = map2_dbl(sd, n, moe.m), 
          ci_low = mean - moe, 
          ci_high = mean + moe, 
          type = "per_session")

rl_hours_mean <- rbind (rl_hours_pd, rl_hours_sc)
             
rl_hours_mean %>%
  ggplot(mapping = aes (x = work_status, y = mean, fill = work_status)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low, 
                    ymax = ci_high),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(mean,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~type)
```

#### By Region

```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_hours_pd <- rl_hours %>%
  filter (region != "NA")%>%
  group_by (region)%>%
  summarise (n = n(),
             mean = mean(hour_pd_md, na.rm = T), 
             sd = sd(hour_pd_md, na.rm = T))%>%
  mutate (moe = map2_dbl(sd, n, moe.m), 
          ci_low = mean - moe, 
          ci_high = mean + moe, 
          type = "per_day")

rl_hours_sc <- rl_hours %>%
  filter (region != "NA")%>%
  group_by (region)%>%
  summarise (n = n(),
             mean = mean(hour_sc_md, na.rm = T), 
             sd = sd(hour_sc_md, na.rm = T))%>%
  mutate (moe = map2_dbl(sd, n, moe.m), 
          ci_low = mean - moe, 
          ci_high = mean + moe, 
          type = "per_session")

rl_hours_mean <- rbind (rl_hours_pd, rl_hours_sc)
             
rl_hours_mean %>%
  ggplot(mapping = aes (x = region, y = mean, fill = region)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low, 
                    ymax = ci_high),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(mean,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~type)
```

##  Quality of Remote Learning
  * Questions:\
    + How do you believe teacher-child interaction quality has changed since adopting remote learning?\
    + How do you believe child-child (i.e., peers) interaction has changed since adopting remote learning?\
  * Responses: - Declined, - About the same, - Improved\
  * Analyses based one the sample of caregivers who reported having child(ren) using remote learning (n = 346)\

### Overall
  * There were 67.92% of caregivers reporting declined teacher-child relationships, and 88.42% of caregivers reporting declined child-child (peer) relationships\ 
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_qlt <- rl %>%
  filter (RL.001 == 1)%>%
  mutate (rl_tc_dec = ifelse (RL.004 == 1, 1, 0), 
          rl_tc_same = ifelse (RL.004 == 2, 1, 0), 
          rl_tc_imp = ifelse (RL.004 == 3, 1, 0), 
          rl_cc_dec = ifelse (RL.005 == 1, 1, 0), 
          rl_cc_same = ifelse (RL.005 == 2, 1, 0), 
          rl_cc_imp = ifelse (RL.005 == 3, 1, 0))

rl_qlt_tc <- rl_qlt %>%
  summarise (n = n(),
             decline = sum(rl_tc_dec, na.rm = T)/n,
             same = sum(rl_tc_same, na.rm = T)/n,
             improve = sum(rl_tc_imp, na.rm = T)/n)%>%
  pivot_longer (cols = c("decline", "same", "improve"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)

rl_qlt_cc <- rl_qlt %>%
  summarise (n = n(),
             decline = sum(rl_cc_dec, na.rm = T)/n,
             same = sum(rl_cc_same, na.rm = T)/n,
             improve = sum(rl_cc_imp, na.rm = T)/n)%>%
  pivot_longer (cols = c("decline", "same", "improve"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
rl_qlt_tc %>%
  ggplot(mapping = aes (x = types, y = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Teacher-Child Relationships")

rl_qlt_cc %>%
  ggplot(mapping = aes (x = types, y = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  ggtitle (label = "Child-Child Relationships")
```

### By Race/Ethnicity
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_qlt_total <- rl_qlt %>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             teacher_child_decline = sum(rl_tc_dec, na.rm = T)/n,
             child_child_decline = sum(rl_cc_dec, na.rm = T)/n)%>%
  pivot_longer (cols = c("teacher_child_decline", "child_child_decline"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)


rl_qlt_total %>%
  ggplot(mapping = aes (x = race_ethnic, y = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~types)


```

### By Poverty Level
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_qlt_total <- rl_qlt %>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             teacher_child_decline = sum(rl_tc_dec, na.rm = T)/n,
             child_child_decline = sum(rl_cc_dec, na.rm = T)/n)%>%
  pivot_longer (cols = c("teacher_child_decline", "child_child_decline"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)


rl_qlt_total %>%
  ggplot(mapping = aes (x = poverty_cat, y = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~types)


```

### By Poverty Level
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_qlt_total <- rl_qlt %>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             teacher_child_decline = sum(rl_tc_dec, na.rm = T)/n,
             child_child_decline = sum(rl_cc_dec, na.rm = T)/n)%>%
  pivot_longer (cols = c("teacher_child_decline", "child_child_decline"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)


rl_qlt_total %>%
  ggplot(mapping = aes (x = poverty_cat, y = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~types)


```

### By Single Parent Status
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_qlt_total <- rl_qlt %>%
  filter (single != "NA")%>%
  group_by (single)%>%
  summarise (n = n(),
             teacher_child_decline = sum(rl_tc_dec, na.rm = T)/n,
             child_child_decline = sum(rl_cc_dec, na.rm = T)/n)%>%
  pivot_longer (cols = c("teacher_child_decline", "child_child_decline"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)


rl_qlt_total %>%
  ggplot(mapping = aes (x = single, y = prop*100, fill = single)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~types)


```

### By Child Disability Status
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_qlt_total <- rl_qlt %>%
  filter (disability != "NA")%>%
  group_by (disability)%>%
  summarise (n = n(),
             teacher_child_decline = sum(rl_tc_dec, na.rm = T)/n,
             child_child_decline = sum(rl_cc_dec, na.rm = T)/n)%>%
  pivot_longer (cols = c("teacher_child_decline", "child_child_decline"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)


rl_qlt_total %>%
  ggplot(mapping = aes (x = disability, y = prop*100, fill = disability)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~types)


```

### By Caregivers' Employment Status
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_qlt_total <- rl_qlt %>%
  filter (work_status != "NA")%>%
  group_by (work_status)%>%
  summarise (n = n(),
             teacher_child_decline = sum(rl_tc_dec, na.rm = T)/n,
             child_child_decline = sum(rl_cc_dec, na.rm = T)/n)%>%
  pivot_longer (cols = c("teacher_child_decline", "child_child_decline"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)


rl_qlt_total %>%
  ggplot(mapping = aes (x = work_status, y = prop*100, fill = work_status)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~types)


```

### By Region
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}

rl_qlt_total <- rl_qlt %>%
  filter (region != "NA")%>%
  group_by (region)%>%
  summarise (n = n(),
             teacher_child_decline = sum(rl_tc_dec, na.rm = T)/n,
             child_child_decline = sum(rl_cc_dec, na.rm = T)/n)%>%
  pivot_longer (cols = c("teacher_child_decline", "child_child_decline"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)


rl_qlt_total %>%
  ggplot(mapping = aes (x = region, y = prop*100, fill = region)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~types)

```

## Who Has Access to Computer/Laptop/Tablet/Other devices
  * Question: During the COVID-19 pandemic, who in your family has access to a computer, laptop, tablet, or other similar devices? Select all that apply:\
    - Me/Spouse/Partner\
    - Older Children\
    - Younger Children\
    - No one has access\
  * Analyses based one the sample of caregivers who reported having child(ren) using remote learning (n = 346)\

### Overall

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_access <- rl %>%
  filter (RL.001 == 1)%>%
  summarise (n = n(),
             a.me_partner = sum(RL.006_1, na.rm = T)/n, 
             b.older_children = sum(RL.006_2, na.rm = T)/n, 
             c.younger_children = sum(RL.006_3, na.rm = T)/n, 
             d.no_one = sum(RL.006_4, na.rm = T)/n)%>%
  pivot_longer(cols = c("a.me_partner", "b.older_children", "c.younger_children", "d.no_one"), names_to = "who", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
rl_access %>%
  ggplot(mapping = aes (x = who, y = prop*100, fill = who)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))
  

```

### By Race/Ethnicity

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_access <- rl %>%
   filter (RL.001 == 1)%>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             a.me_partner = sum(RL.006_1, na.rm = T)/n, 
             b.older_children = sum(RL.006_2, na.rm = T)/n, 
             c.younger_children = sum(RL.006_3, na.rm = T)/n, 
             )%>%
  pivot_longer(cols = c("a.me_partner", "b.older_children", "c.younger_children" ), names_to = "who", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
rl_access %>%
  ggplot(mapping = aes (x = race_ethnic, y = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~who)

```


### By Poverty Level

  *Significant more high-income families' caregivers had access to electrical devices compared to low-income families\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_access <- rl %>%
   filter (RL.001 == 1)%>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             a.me_partner = sum(RL.006_1, na.rm = T)/n, 
             b.older_children = sum(RL.006_2, na.rm = T)/n, 
             c.younger_children = sum(RL.006_3, na.rm = T)/n, 
             )%>%
  pivot_longer(cols = c("a.me_partner", "b.older_children", "c.younger_children" ), names_to = "who", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
rl_access %>%
  ggplot(mapping = aes (x = poverty_cat, y = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~who)

```


### By Single Parent Status

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_access <- rl %>%
   filter (RL.001 == 1)%>%
  filter (single != "NA")%>%
  group_by (single)%>%
  summarise (n = n(),
             a.me_partner = sum(RL.006_1, na.rm = T)/n, 
             b.older_children = sum(RL.006_2, na.rm = T)/n, 
             c.younger_children = sum(RL.006_3, na.rm = T)/n, 
             )%>%
  pivot_longer(cols = c("a.me_partner", "b.older_children", "c.younger_children"), names_to = "who", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
rl_access %>%
  ggplot(mapping = aes (x = single, y = prop*100, fill = single)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~who)

```


### By Children's Disability Status
  
  * Significantly more young children in families of children with special needs have access to electrical devices compared to families of children without special needs\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_access <- rl %>%
   filter (RL.001 == 1)%>%
  filter (disability != "NA")%>%
  group_by (disability)%>%
  summarise (n = n(),
             a.me_partner = sum(RL.006_1, na.rm = T)/n, 
             b.older_children = sum(RL.006_2, na.rm = T)/n, 
             c.younger_children = sum(RL.006_3, na.rm = T)/n, 
             )%>%
  pivot_longer(cols = c("a.me_partner", "b.older_children", "c.younger_children"), names_to = "who", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
rl_access %>%
  ggplot(mapping = aes (x = disability, y = prop*100, fill = disability)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~who)

```


### By Caregivers' Employment Status

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_access <- rl %>%
   filter (RL.001 == 1)%>%
  filter (work_status != "NA")%>%
  group_by (work_status)%>%
  summarise (n = n(),
             a.me_partner = sum(RL.006_1, na.rm = T)/n, 
             b.older_children = sum(RL.006_2, na.rm = T)/n, 
             c.younger_children = sum(RL.006_3, na.rm = T)/n, 
            )%>%
  pivot_longer(cols = c("a.me_partner", "b.older_children", "c.younger_children"), names_to = "who", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
rl_access %>%
  ggplot(mapping = aes (x = work_status, y = prop*100, fill = work_status)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~who)

```


### By Region

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_access <- rl %>%
   filter (RL.001 == 1)%>%
  filter (region != "NA")%>%
  group_by (region)%>%
  summarise (n = n(),
             a.me_partner = sum(RL.006_1, na.rm = T)/n, 
             b.older_children = sum(RL.006_2, na.rm = T)/n, 
             c.younger_children = sum(RL.006_3, na.rm = T)/n, 
             )%>%
  pivot_longer(cols = c("a.me_partner", "b.older_children", "c.younger_children"), names_to = "who", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
rl_access %>%
  ggplot(mapping = aes (x = region, y = prop*100, fill = region)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~who)

```

## Screen Time Help Learning
  * Question: To which extent do you think screen time helps with your child's learning?\
    - 1 = Very Effective\
    - 2 = Somewhat Effective\
    - 3 = A mixture\
    - 4 = Somewhat ineffective\
    - 5 = Very ineffective\
  * Analyses based one the sample of caregivers who reported having child(ren) using remote learning (n = 346)\

### Overall
  * About half (48.27%) of caregivers thought remote learning was a mixture, 27.75% thought it was effective, and 23.99% thought it was ineffective\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_eff <- rl %>%
   filter (RL.001 == 1)%>%
  mutate (rl_eff = ifelse (RL.009 == 1 | RL.009 == 2, 1, 0), 
          rl_mixture = ifelse (RL.009 == 3, 1, 0), 
          rl_ineff = ifelse (RL.009 == 4 | RL.009 == 5, 1, 0))

rl_eff_total <- rl_eff %>%
  summarise (n = n(),
             a.effective = sum(rl_eff, na.rm = T)/n, 
             b.mixture = sum(rl_mixture, na.rm = T)/n, 
             c.ineffective = sum(rl_ineff, na.rm = T)/n, 
             )%>%
  pivot_longer(cols = c("a.effective", "b.mixture", "c.ineffective"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
rl_eff_total %>%
  ggplot(mapping = aes (x = types, y = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))

```

### By Race/Ethnicity

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_eff_total <- rl_eff %>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             a.effective = sum(rl_eff, na.rm = T)/n, 
             b.mixture = sum(rl_mixture, na.rm = T)/n, 
             c.ineffective = sum(rl_ineff, na.rm = T)/n, 
             )%>%
  pivot_longer(cols = c("a.effective", "b.mixture", "c.ineffective"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
rl_eff_total %>%
  ggplot(mapping = aes (x = race_ethnic, y = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~types)

```

### By Poverty Level

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_eff_total <- rl_eff %>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             a.effective = sum(rl_eff, na.rm = T)/n, 
             b.mixture = sum(rl_mixture, na.rm = T)/n, 
             c.ineffective = sum(rl_ineff, na.rm = T)/n, 
             )%>%
  pivot_longer(cols = c("a.effective", "b.mixture", "c.ineffective"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
rl_eff_total %>%
  ggplot(mapping = aes (x = poverty_cat, y = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~types)

```

### By Single Parent Status

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_eff_total <- rl_eff %>%
  filter (single != "NA")%>%
  group_by (single)%>%
  summarise (n = n(),
             a.effective = sum(rl_eff, na.rm = T)/n, 
             b.mixture = sum(rl_mixture, na.rm = T)/n, 
             c.ineffective = sum(rl_ineff, na.rm = T)/n, 
             )%>%
  pivot_longer(cols = c("a.effective", "b.mixture", "c.ineffective"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
rl_eff_total %>%
  ggplot(mapping = aes (x = single, y = prop*100, fill = single)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~types)

```

### By Disability Status

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_eff_total <- rl_eff %>%
  filter (disability != "NA")%>%
  group_by (disability)%>%
  summarise (n = n(),
             a.effective = sum(rl_eff, na.rm = T)/n, 
             b.mixture = sum(rl_mixture, na.rm = T)/n, 
             c.ineffective = sum(rl_ineff, na.rm = T)/n, 
             )%>%
  pivot_longer(cols = c("a.effective", "b.mixture", "c.ineffective"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
rl_eff_total %>%
  ggplot(mapping = aes (x = disability, y = prop*100, fill = disability)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~types)

```

### By Caregivers' Employment Status

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_eff_total <- rl_eff %>%
  filter (work_status != "NA")%>%
  group_by (work_status)%>%
  summarise (n = n(),
             a.effective = sum(rl_eff, na.rm = T)/n, 
             b.mixture = sum(rl_mixture, na.rm = T)/n, 
             c.ineffective = sum(rl_ineff, na.rm = T)/n, 
             )%>%
  pivot_longer(cols = c("a.effective", "b.mixture", "c.ineffective"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
rl_eff_total %>%
  ggplot(mapping = aes (x = work_status, y = prop*100, fill = work_status)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~types)

```

### By Region

```{r, echo=FALSE, message = FALSE, warning = FALSE}
rl_eff_total <- rl_eff %>%
  filter (region != "NA")%>%
  group_by (region)%>%
  summarise (n = n(),
             a.effective = sum(rl_eff, na.rm = T)/n, 
             b.mixture = sum(rl_mixture, na.rm = T)/n, 
             c.ineffective = sum(rl_ineff, na.rm = T)/n, 
             )%>%
  pivot_longer(cols = c("a.effective", "b.mixture", "c.ineffective"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
rl_eff_total %>%
  ggplot(mapping = aes (x = region, y = prop*100, fill = region)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~types)

```

# Internet Access

## Internet Availability to Children and Caregivers
  * Questions: \
    + How often is the internet available to children for educational purposes?\
    + How often is the internet available to you (the caregiver)?\
  * Responses:\
    - Never available; Rarely available; Sometimes available; Usually available; Always available \
    - Never & rarely & sometimes coded as "not usually available", the other options coded as "usually available"\
  * Analyses based one the sample of caregivers who reported having child(ren) using remote learning (n = 346)\

### Overall
  * The vast majority (>90%) of caregivers reported that they and their children usually have access to the Internet\
  * Note that because of the small sample size for participants who reported no avaiability to Internet, breakdown group analyses were only conducted by race/ethnicity, and by poverty levels. \
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
internet_avl <- internet %>%
  filter (is.na(INTERNET.001) == FALSE)%>%
  mutate (c_not_available = ifelse (INTERNET.001 %in% c (1,2,3), 1, 0), 
          c_available = ifelse (INTERNET.001 %in% c (4,5), 1, 0), 
          p_not_available = ifelse (INTERNET.002 %in% c (1,2,3), 1, 0), 
          p_available = ifelse (INTERNET.002 %in% c (4,5), 1, 0))

internet_avl_total <- internet_avl %>%
  summarise (n = n(),
             c_not_available = sum(c_not_available, na.rm = T)/n, 
             p_not_available = sum(p_not_available, na.rm = T)/n, 
             c_available = sum(c_available, na.rm = T)/n, 
             p_available = sum(p_available, na.rm = T)/n,
             )%>%
  pivot_longer(cols = c("c_not_available", "p_not_available","c_available" ,"p_available"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
internet_avl_total %>%
  ggplot(mapping = aes (x = types, y = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))
```

### By Race/Ethnicity
  * Note that the sample size in Black and Latinx families were very small in this analysis\
  
```{r, echo=FALSE, message = FALSE, warning = FALSE}
internet_avl_total <- internet_avl %>%
  filter (race_ethnic != "NA")%>%
  group_by (race_ethnic)%>%
  summarise (n = n(),
             c_not_available = sum(c_not_available, na.rm = T)/n, 
             p_not_available = sum(p_not_available, na.rm = T)/n, 
             )%>%
  pivot_longer(cols = c("c_not_available", "p_not_available"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
internet_avl_total %>%
  ggplot(mapping = aes (x = race_ethnic, y = prop*100, fill = race_ethnic)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~types)
```

### By Poverty Level

```{r, echo=FALSE, message = FALSE, warning = FALSE}
internet_avl_total <- internet_avl %>%
  filter (poverty_cat != "NA")%>%
  group_by (poverty_cat)%>%
  summarise (n = n(),
             c_not_available = sum(c_not_available, na.rm = T)/n, 
             p_not_available = sum(p_not_available, na.rm = T)/n, 
             )%>%
  pivot_longer(cols = c("c_not_available", "p_not_available"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
internet_avl_total %>%
  ggplot(mapping = aes (x = poverty_cat, y = prop*100, fill = poverty_cat)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))+
  facet_wrap (~types)
```


## Who Paid for Internet Services
  * Question: Are internet services...? Select all that apply\
    - Paid for by children's school or school district\
    - Paid for by someone in the household or family\
    - Paid for by another source\
  * Results showed that the vast majority (97.75%) of families' internet was paid for by someone in the household or family\
    
```{r, echo=FALSE, message = FALSE, warning = FALSE}
internet_pay <- internet %>%
  filter (is.na (INTERNET.003_1) == F |is.na (INTERNET.003_2) == F |is.na (INTERNET.003_3) == F)%>%
  summarise (n = n(),
             school = sum(INTERNET.003_1, na.rm = T)/n, 
             family = sum(INTERNET.003_2, na.rm = T)/n, 
             other = sum(INTERNET.003_3, na.rm = T)/n
             )%>%
  pivot_longer(cols = c("school", "family","other"), names_to = "types", values_to = "prop")%>%
  mutate (count = prop * n,
          moe = map2_dbl(prop, n, moe.p), 
          ci_low = prop - moe, 
          ci_high = prop + moe)
             
internet_pay %>%
  ggplot(mapping = aes (x = types, y = prop*100, fill = types)) +
  geom_bar (stat = "identity", position = position_dodge(1))+
  geom_errorbar(aes(ymin = ci_low*100, 
                    ymax = ci_high*100),
                    width = .3,
                    position = position_dodge(1)) +
  geom_text(aes(label = round(prop*100,2)),vjust = -1, color = "black", size =3, position = position_dodge(1))
```